<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2-4電子科カジノ 受付画面</title>
    <!-- Tailwind CSSのロード -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* JSによるリダイレクトが完了するまで、画面を真っ白に保ちます */
        body {
            background-color: #f7f7f7;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }
    </style>
</head>
<body>
    <!-- 画面が一瞬たりとも表示されないようにするため、コンテンツは空にしておく -->
    <div id="content"></div> 

    <script>
        // --- 訪問者を識別するJavaScript ---
        const VISITED_KEY = 'festival_visited_count'; // 訪問回数を示すキー
        const REDIRECT_URL = 'thankyou.html'; 
        
        // Local Storageから回数を取得（なければ0）
        let visitCount = parseInt(localStorage.getItem(VISITED_KEY) || '0', 10);
        
        // 現在のURLからファイル名を除いたディレクトリパスを取得し、絶対URLを構成
        // 例: 'https://example.com/index.html' -> 'https://example.com/'
        const currentPath = window.location.href.substring(0, window.location.href.lastIndexOf('/') + 1);

        
        // 初回アクセス時 (1回目)
        if (visitCount === 0) {
            // 1回目：訪問履歴を保存 (1を設定)
            localStorage.setItem(VISITED_KEY, '1');
            
            // 【重要】Form誘導画面 (count=2) に強制リダイレクト
            // 絶対URLを生成
            const absoluteUrl = `${currentPath}${REDIRECT_URL}?count=2`;
            window.location.assign(absoluteUrl); 

        } 
        // 2回目以降のアクセス時
        else {
            // 2回目以降：訪問履歴を更新 (常に 2 に固定)
            localStorage.setItem(VISITED_KEY, '2'); 
            
            // 【重要】チップ付与画面 (count=3) に強制リダイレクト
            // 絶対URLを生成
            const absoluteUrl = `${currentPath}${REDIRECT_URL}?count=3`;
            window.location.assign(absoluteUrl);
        }

        // リダイレクト処理が完了するまで、画面が切り替わるのを防ぐ
    </script>
</body>
</html>
